<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>MS-DOS Simulator</title>
<link rel="icon" type="image/png" href="Website-Guide.png" />
<style>
:root {
  --bg: #1e1e1e;
  --panel: #000;
  --accent: #00ff00;
  --text: #c7c7c7;
  --max-width: 1000px;
}
* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}
body {
  font-family: "Courier New", monospace;
  background: var(--bg);
  color: var(--text);
  min-height: 100vh;
  display: flex;
  flex-direction: column;
}
/* HEADER */
header {
  position: fixed;
  top: 0; left: 0; right: 0;
  background: var(--panel);
  padding: 12px 20px;
  z-index: 1000;
  box-shadow: 0 2px 6px rgba(0,0,0,0.7);
}
.header-top {
  display: flex;
  justify-content: center;
  align-items: center;
}
.logo {
  font-size: 22px;
  font-weight: bold;
  color: var(--accent);
  white-space: nowrap;
}
/* NAVBAR - 1 LINE ALWAYS VISIBLE */
nav {
  margin-top: 10px;
  overflow-x: auto;
  white-space: nowrap;
  -webkit-overflow-scrolling: touch;
}
nav::-webkit-scrollbar { display: none; }
nav ul {
  list-style: none;
  display: flex;
  gap: 20px;
}
nav a {
  color: var(--accent);
  text-decoration: none;
  padding: 8px 10px;
  border-radius: 4px;
  transition: 0.2s;
  white-space: nowrap;
}
nav a:hover {
  background: rgba(0,255,0,0.1);
}
/* REMOVE DROPDOWNS COMPLETELY */
.dropdown { display: none !important; }
/* RESPONSIVE */
@media (min-width: 769px) {
  header {
    display: flex;
    flex-direction: column;
    align-items: center;
  }
}
@media (max-width: 768px) {
  header {
    display: block;
  }
}
/* MAIN CONTENT */
main {
  flex: 1;
  max-width: var(--max-width);
  margin: 0 auto;
  padding: 140px 20px 80px;
}
main h2 {
  color: var(--accent);
  margin-bottom: 10px;
}
main p {
  margin-bottom: 15px;
  font-size: 18px;
  line-height: 1.6;
}
/* terminal look */
.terminal-wrap {
  background:#050505;
  border-radius:6px;
  padding:16px;
  min-height:60vh;
  max-height:65vh;
  overflow:auto;
  box-shadow:0 8px 24px rgba(0,0,0,0.6);
  border:1px solid rgba(0,255,0,0.06);
  color:var(--accent);
  font-size:15px;
  line-height:1.35;
  white-space: pre-wrap;
}
.line {
  color: var(--text);
  white-space: pre-wrap;
  word-break: break-word;
}
/* fixed input bar at bottom (DOS style) */
.input-bar {
  position: fixed;
  left: 0; right: 0; bottom: 0;
  background: var(--panel);
  padding: 10px 14px;
  border-top: 1px solid rgba(255,255,255,0.03);
  display: flex;
  gap: 8px;
  align-items: center;
}
.prompt {
  color: var(--accent);
  min-width: 140px;
  user-select: none;
  font-family: inherit;
  font-size: 20px;
}
.cmdline {
  flex: 1;
  background: transparent;
  border: 0;
  outline: 0;
  color: var(--text);
  font-family: inherit;
  font-size: 15px;
  padding: 6px 8px;
}
.btn {
  background: rgba(0,255,0,0.06);
  color: var(--accent);
  border: 1px solid rgba(0,255,0,0.06);
  padding: 6px 10px;
  border-radius: 4px;
  cursor: pointer;
}
/* small screens */
@media (max-width:600px){
  .prompt { min-width: 100px; }
}
/* Hide default scrollbar */
::-webkit-scrollbar {
  display: none;
}
nav::-webkit-scrollbar {
  display: none;
}
#closeEditorBtn {
  background: #000;
  color: #0f0;
  border: 1px solid #0f0;
  padding: 5px 10px;
  cursor: pointer;
  align-self: flex-start;
}
#landscape-warning {
  position: fixed;
  top: 0; left: 0;
  width: 100%; height: 100%;
  background: rgba(0,0,0,0.8);
  color: white;
  display: flex;
  justify-content: center;
  align-items: center;
  z-index: 9999;
}

.warning-box {
  background: #222;
  border: 2px solid #555;
  padding: 20px;
  border-radius: 8px;
  width: 80%;
  max-width: 350px;
  text-align: center;
  font-family: sans-serif;
}

.warning-box button {
  margin: 8px;
  padding: 10px 20px;
  font-size: 16px;
  border: none;
  border-radius: 6px;
  cursor: pointer;
}

#ok-btn { background: #4caf50; color: white; }
#why-btn { background: #555; color: white; }

</style>
</head>
<body>
<header>
  <div class="header-top"><div class="logo">MS-DOS Guide</div></div>
  <nav>
    <ul>
      <li><a href="MS-DOS_main.html#home">Home</a></li>
      <li><a href="MS-DOS_main.html#az">A-Z Commands</a></li>
      <li><a href="MS-DOS_main.html#other">Other Commands</a></li>
      <li><a href="MS-DOS_Simulator.html">Simulator</a></li>
      <li><a href="MS-DOS_main.html#tips">Tips</a></li>
      <li><a href="MS-DOS_main.html#setup">Setup</a></li>
      <li><a href="MS-DOS_main.html#trouble">Troubleshooting</a></li>
      <li><a href="MS-DOS_main.html#history">History</a></li>
      <li><a href="MS-DOS_main.html#about">About</a></li>
    </ul>
  </nav>
</header>
<div id="landscape-warning" style="display:none;">
  <div class="warning-box">
    <h3>Landscape Mode Needed</h3>
    <p id="warning-text">This works best in landscape mode. Turn your phone over!</p>
    <p id="warning-text">Note: Navigation bar brakes in landscape mode go to potrait mode to use it</p>

    <button id="ok-btn">OK</button>
    <button id="why-btn">Why?</button>
  </div>
</div>

<main>
  <h2>Interactive MS-DOS Simulator</h2>
  <p style="color:#9aa; margin-bottom:14px;">Filesystem persisted to <code>localStorage</code>. Type <code>help</code>. Use <code>restart</code> to reset to original.</p>

  <div id="terminal" class="terminal-wrap" tabindex="0" aria-live="polite"></div>
</main>

<div class="input-bar">
  <div id="prompt" class="prompt">C:\></div>
  <input id="cmd" class="cmdline" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" />
  <button id="enterBtn" class="btn">Enter</button>
</div>

<div id="editorOverlay">
  <textarea id="fileEditor" spellcheck="false"></textarea>
  <button id="closeEditorBtn">Close Editor</button>
</div>

<script>

const STORAGE_KEY = "simulator.0.2";

/* ================= FILESYSTEM ================= */

const ORIGINAL = {
  cwd: ["C:"],
  ver: "MS-DOS Simulator v2.0 (Simulated)",
  memKB: 8192,
  root: {
    "C:": {
      type: "dir",
      children: {

        "PROGRAMS": {
          type: "dir",
          children: {
            "EDIT.EXE": { type: "file", content: "DOS text editor\n" },
            "SCAN.EXE": { type: "file", content: "Virus scanner utility\n" },
            "SYSINFO.EXE": { type: "file", content: "System information tool\n" },
            "FORMAT.EXE": { type: "file", content: "Disk formatting utility\n" },
            "CHKDSK.EXE": { type: "file", content: "Check disk status\n" },
            "BACKUP.EXE": { type: "file", content: "Backup program\n" },

            "UTILS": {
              type: "dir",
              children: {
                "ZIP.EXE": { type: "file", content: "Compression utility\n" },
                "UNZIP.EXE": { type: "file", content: "Extract compressed files\n" },
                "HEXVIEW.EXE": { type: "file", content: "Hexadecimal file viewer\n" }
              }
            },

            "TEXTDOCUMENTS": {
              type: "dir",
              children: {
                "README.TXT": { type: "file", content: "Welcome to MS-DOS Guide\n" },
                "NOTES.TXT": { type: "file", content: "Personal notes\n" },
                "COMMANDS.TXT": { type: "file", content: "DIR, CD, COPY, DEL...\n" },
                "AFEFYS.TXT": { type: "file", content: "These are your weird notes.\n" }
              }
            }
          }
        },

"GAMES": {
  type: "dir",
  children: {
"SNAKE.EXE": {
  type: "file",
  content: "Classic snake game\n",
  href: "snake.html"
},
"TETRIS.EXE": {
  type: "file",
  content: "Block stacking game\n",
  href: "tetris.html"
}
  }
},

        "DRIVERS": {
          type: "dir",
          children: {
            "MOUSE.DRV": { type: "file", content: "Mouse driver\n" },
            "KEYBOARD.DRV": { type: "file", content: "Keyboard driver\n" },
            "SOUND.DRV": { type: "file", content: "Sound Blaster driver\n" }
          }
        },

        "CONFIG": {
          type: "dir",
          children: {
            "CONFIG.SYS": {
              type: "file",
              content: "DEVICE=HIMEM.SYS\nDEVICE=EMM386.EXE\n"
            },
            "AUTOEXEC.BAT": {
              type: "file",
              content: "@ECHO OFF\nPATH C:\\PROGRAMS\nPROMPT $P$G\n"
            }
          }
        },

        "LOGS": {
          type: "dir",
          children: {
            "BOOT.LOG": { type: "file", content: "System boot successful\n" },
            "ERROR.LOG": { type: "file", content: "No errors detected\n" }
          }
        }

      }
    }
  }
};

function saveFS(fs) {
  localStorage.setItem(STORAGE_KEY, JSON.stringify(fs));
}

function loadFS() {
  const raw = localStorage.getItem(STORAGE_KEY);
  if (!raw) {
    saveFS(ORIGINAL);
    return JSON.parse(JSON.stringify(ORIGINAL));
  }
  try {
    return JSON.parse(raw);
  } catch {
    saveFS(ORIGINAL);
    return JSON.parse(JSON.stringify(ORIGINAL));
  }
}

let FS = loadFS();
let cwdPath = [...FS.cwd];

/* ================= UI ================= */

const terminal = document.getElementById("terminal");
const input = document.getElementById("cmd");
const enterBtn = document.getElementById("enterBtn");
const promptEl = document.getElementById("prompt");
const editorOverlay = document.getElementById("editorOverlay");
const fileEditor = document.getElementById("fileEditor");

let currentEditingFile = null;

/* ================= HELPERS ================= */

function appendLine(text) {
  const div = document.createElement("div");
  div.className = "line";
  div.textContent = text;
  terminal.appendChild(div);
  terminal.scrollTop = terminal.scrollHeight;
}

function appendLines(lines) {
  lines.forEach(appendLine);
}

function updatePrompt() {
  promptEl.textContent = cwdPath.join("\\") + ">";
}

updatePrompt();

/* ================= PATH ================= */

function normalizePath(input) {
  if (!input) return null;
  input = input.trim();

  let base = input.match(/^[A-Za-z]:\\/i)
    ? [input.slice(0, 2).toUpperCase()]
    : [...cwdPath];

  const rest = input.replace(/^[A-Za-z]:\\/i, "");
  rest.split("\\").forEach(p => {
    p = p.toUpperCase();
    if (p === ".." && base.length > 1) base.pop();
    else if (p && p !== ".") base.push(p);
  });

  return base;
}

function pathToNode(path) {
  if (!path || path.length === 0) return null;

  let node = FS.root[path[0]];
  if (!node) return null;

  for (let i = 1; i < path.length; i++) {
    if (!node.children) return null;

    const next = node.children[path[i]];
    if (!next) return null;

    node = next;
  }

  return node;
}


function findParent(path) {
  if (path.length === 1) return { parent: FS.root, name: path[0] };
  let parent = FS.root[path[0]];
  for (let i = 1; i < path.length - 1; i++) {
    parent = parent.children?.[path[i]];
    if (!parent) return {};
  }
  return { parent, name: path[path.length - 1] };
}

/* ================= EDITOR ================= */

function openFileEditor(path) {
  const { parent, name } = findParent(path);
  if (!parent || !parent.children[name] || parent.children[name].type !== "file") {
    appendLine("File not found.");
    return;
  }
  currentEditingFile = { parent, name };
  fileEditor.value = parent.children[name].content || "";
  editorOverlay.style.display = "flex";
  input.disabled = true;
}

function closeFileEditor() {
  if (!currentEditingFile) return;
  currentEditingFile.parent.children[currentEditingFile.name].content = fileEditor.value;
  saveFS(FS);
  appendLine("-- File saved --");
  currentEditingFile = null;
  editorOverlay.style.display = "none";
  input.disabled = false;
  input.focus();
}

/* ================= COMMANDS ================= */

const COMMANDS = {

  help() {
    appendLines([
      "Supported commands:",
      " BASIC: help, dir, cd, cls, type, copy, del, move, ren, mkdir, rmdir",
      " SYSTEM: mem, ver",
      " PROGRAMS: edit",
      " OTHER: open, close, restart"
    ]);
  },

  cls() {
    terminal.innerHTML = "";
  },

  ver() {
    appendLine(FS.ver);
  },

  mem() {
    appendLine(`${FS.memKB}K conventional memory available.`);
  },

  dir(args) {
    const path = args[0] ? normalizePath(args[0]) : cwdPath;
    const node = pathToNode(path);
    if (!node || node.type !== "dir") {
      appendLine("File not found.");
      return;
    }
    appendLine(" Directory of " + path.join("\\"));
    Object.keys(node.children).forEach(n =>
      appendLine(node.children[n].type === "dir" ? "<DIR> " + n : "      " + n)
    );
  },

cd(args) {
  if (!args[0]) return;

  const targetPath = normalizePath(args[0]);
  const node = pathToNode(targetPath);

  // ðŸš€ EXE launcher
  if (node && node.type === "file" && node.href) {
    appendLine("Launching " + targetPath[targetPath.length - 1] + "...");
    setTimeout(() => {
      window.location.href = node.href;
    }, 500);
    return;
  }

  // Normal directory change
  if (!node || node.type !== "dir") {
    appendLine("The system cannot find the path specified.");
    return;
  }

  cwdPath = targetPath;
  FS.cwd = targetPath;
  saveFS(FS);
  updatePrompt();
},

mkdir(args) {
  if (!args[0]) {
    appendLine("Syntax: mkdir foldername");
    return;
  }
  const path = normalizePath(args[0]);
  const { parent, name } = findParent(path);
  if (!parent || parent.children[name]) {
    appendLine("Cannot create directory.");
    return;
  }
  parent.children[name] = { type: "dir", children: {} };
  saveFS(FS);
  appendLine("Directory created.");
},


  rmdir(args) {
    const path = normalizePath(args[0]);
    const { parent, name } = findParent(path);
    if (!parent || !parent.children[name] || parent.children[name].type !== "dir") {
      appendLine("Directory not found.");
      return;
    }
    if (Object.keys(parent.children[name].children).length) {
      appendLine("Directory not empty.");
      return;
    }
    delete parent.children[name];
    saveFS(FS);
    appendLine("Directory removed.");
  },

  type(args) {
    const path = normalizePath(args[0]);
    const { parent, name } = findParent(path);
    const file = parent?.children[name];
    if (!file || file.type !== "file") {
      appendLine("File not found.");
      return;
    }
    appendLine(file.content);
  },

  copy(args) {
    const src = normalizePath(args[0]);
    const dst = normalizePath(args[1]);
    const s = findParent(src);
    const d = findParent(dst);
    if (!s.parent || !d.parent || !s.parent.children[s.name]) {
      appendLine("Copy failed.");
      return;
    }
    d.parent.children[d.name] = {
      type: "file",
      content: s.parent.children[s.name].content
    };
    saveFS(FS);
    appendLine("File copied.");
  },

  del(args) {
    const path = normalizePath(args[0]);
    const { parent, name } = findParent(path);
    if (!parent || !parent.children[name]) {
      appendLine("File not found.");
      return;
    }
    delete parent.children[name];
    saveFS(FS);
    appendLine("File deleted.");
  },

  move(args) {
    const src = normalizePath(args[0]);
    const dst = normalizePath(args[1]);
    const s = findParent(src);
    const d = findParent(dst);
    if (!s.parent || !d.parent) {
      appendLine("Move failed.");
      return;
    }
    d.parent.children[d.name] = s.parent.children[s.name];
    delete s.parent.children[s.name];
    saveFS(FS);
    appendLine("File moved.");
  },

  ren(args) {
    const path = normalizePath(args[0]);
    const { parent, name } = findParent(path);
    const newName = args[1]?.toUpperCase();
    if (!parent || !newName) return;
    parent.children[newName] = parent.children[name];
    delete parent.children[name];
    saveFS(FS);
    appendLine("Renamed.");
  },

  edit(args) {
    openFileEditor(normalizePath(args[0]));
  },

  open(args) {
    openFileEditor(normalizePath(args[0]));
  },

  restart() {
    FS = JSON.parse(JSON.stringify(ORIGINAL));
    cwdPath = [...FS.cwd];
    saveFS(FS);
    terminal.innerHTML = "";
    updatePrompt();
    appendLine("Simulator reset.");
  }
};

/* ================= EXEC ================= */

function runCommand(line) {
  if (!line.trim()) return;
  appendLine(cwdPath.join("\\") + "> " + line);
  const [cmd, ...args] = line.trim().split(/\s+/);
  const fn = COMMANDS[cmd.toLowerCase()];
  fn ? fn(args) : appendLine("Bad command or file name.");
}

enterBtn.onclick = () => {
  runCommand(input.value);
  input.value = "";
};

input.onkeydown = e => {
  if (e.key === "Enter") {
    runCommand(input.value);
    input.value = "";
  }
};

/* Initialize prompt and focus */
updatePrompt();
input.focus();

</script>
<script>
function isMobile() {
  return /Android|iPhone|iPad|iPod|Opera Mini|IEMobile|WPDesktop/i.test(navigator.userAgent);
}

function checkOrientation() {
  if (!isMobile()) return; // ignore on PC

  const warning = document.getElementById("landscape-warning");

  if (window.innerWidth < window.innerHeight) {
    // Portrait mode
    warning.style.display = "flex";
    document.getElementById("warning-text").innerText =
      "This only works in landscape mode. Turn your phone over.";
  } else {
    // Landscape mode
    warning.style.display = "none";
  }
}

// Buttons
document.getElementById("ok-btn").onclick = () => {
  document.getElementById("landscape-warning").style.display = "none";
};

document.getElementById("why-btn").onclick = () => {
  document.getElementById("warning-text").innerText =
    "The simulator was made for pc but needs landscape mode to work correctly!";
};

// Check on load and when rotating
window.addEventListener("load", checkOrientation);
window.addEventListener("resize", checkOrientation);
</script>

</body>
</html>
